<!DOCTYPE html>
<html>

<head>
  <title>Diet Plan Generator</title>
  <link rel="icon" type="image/x-icon" href="./img/ai.svg" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" />
  <script type="module" src="https://unpkg.com/ionicons@6.0.0/dist/ionicons/ionicons.esm.js"></script>
  <script nomodule src="https://unpkg.com/ionicons@6.0.0/dist/ionicons/ionicons.js"></script>
  <style>
    /* 1st change */
    @import url("https://fonts.googleapis.com/css2?family=Poppins&display=swap");

    :root {
      /**
* colors
*/

      --st-patricks-blue: hsl(236, 57%, 28%);
      --amaranth-purple: hsl(335, 88%, 38%);
      --royal-blue-dark: hsl(231, 68%, 21%);
      --chrome-yellow: hsl(39, 100%, 52%);
      --space-cadet-1: hsl(230, 41%, 25%);
      --space-cadet-2: hsl(230, 59%, 16%);
      --winter-sky_50: hsla(335, 87%, 53%, 0.5);
      --purple-navy: hsl(236, 26%, 43%);
      --ksu-purple: hsl(275, 54%, 33%);
      --winter-sky: hsl(335, 87%, 53%);
      --razzmatazz: hsl(335, 87%, 51%);
      --platinum: hsl(0, 0%, 90%);
      --black_70: hsla(0, 0%, 0%, 0.7);
      --rajah: hsl(29, 99%, 67%);
      --white: hsl(0, 0%, 100%);
      --color: var(--white);
      --gradient-1: linear-gradient(90deg,
          var(--royal-blue-dark) 0,
          var(--ksu-purple) 51%,
          var(--royal-blue-dark));
      --gradient-2: linear-gradient(90deg, var(--razzmatazz), var(--rajah));

      /**
* typography
*/

      --ff-source-sans-pro: "Source Sans Pro", sans-serif;
      --ff-poppins: "Poppins", sans-serif;

      --fs-1: 4.2rem;
      --fs-2: 3.8rem;
      --fs-3: 3.2rem;
      --fs-4: 2.5rem;
      --fs-5: 2.4rem;
      --fs-6: 2rem;
      --fs-7: 1.8rem;
      --fs-8: 1.5rem;

      --fw-500: 500;
      --fw-600: 600;
      --fw-700: 700;

      /**
* border radius
*/

      --radius-4: 4px;
      --radius-12: 12px;

      /**
* spacing
*/

      --section-padding: 60px;

      /**
* transition
*/

      --transition-1: 0.15s ease;
      --transition-2: 0.35s ease;
      --cubic-in: cubic-bezier(0.51, 0.03, 0.64, 0.28);
      --cubic-out: cubic-bezier(0.33, 0.85, 0.56, 1.02);

      /**
* shadow
*/

      --shadow: 0 5px 20px 1px hsla(220, 63%, 33%, 0.1);
    }

    body {
      font-family: "Open Sans", sans-serif;
      color: #fff;
    }

    .hero {
      padding-top: 10%;
      background-image: linear-gradient(90deg,
          hsl(231, 68%, 21%) 0,
          hsl(275, 54%, 33%) 51%,
          hsl(231, 68%, 21%));
    }

    .table {
      color: #fff;
    }

    a,
    img,
    span,
    input,
    button,
    ion-icon {
      display: block;
    }

    li {
      list-style: none;
    }

    li a {
      text-decoration: none;
    }

    li a:hover {
      color: white;
      text-shadow: 2px 2px #556270;
      text-decoration: none;
    }

    button,
    input {
      background: none;
      border: none;
      font: inherit;
    }

    a {
      text-decoration: none;
      color: #d9232d;
    }

    a:hover {
      color: #e24d55;
      text-decoration: none;
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      font-family: "Raleway", sans-serif;
      color: #fff;
      font-size: larger;
    }

    /*--------------------------------------------------------------
  # Back to top button
  --------------------------------------------------------------*/
    .back-to-top {
      position: fixed;
      visibility: hidden;
      opacity: 0;
      right: 15px;
      bottom: 15px;
      z-index: 996;
      background: #d9232d;
      width: 40px;
      height: 40px;
      border-radius: 4px;
      transition: all 0.4s;
    }

    .back-to-top i {
      font-size: 28px;
      color: #fff;
      line-height: 0;
    }

    .back-to-top:hover {
      background: #e1444d;
      color: #fff;
    }

    .back-to-top.active {
      visibility: visible;
      opacity: 1;
    }

    /*--------------------------------------------------------------
  # Header
  --------------------------------------------------------------*/
    .header {
      --color: var(--white);
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      padding-block: 14px;
      z-index: 4;
      transition: var(--transition-1);
    }

    .header.active {
      --color: var(--st-patricks-blue);
      position: fixed;
      background-color: var(--white);
      box-shadow: 0 2px 30px hsla(0, 0%, 0%, 0.1);
    }

    .logo {
      color: white;
      font-size: 30px;
      margin: 0;
      padding: 0;
      line-height: 1;
      font-weight: 700;
      text-transform: uppercase;
    }

    .logo a:hover {
      text-decoration: none;
    }

    .header .logo a {
      color: white;
      text-decoration: none;
    }

    .header .logo a:hover {
      text-shadow: 2px 2px#556270;
    }

    .header .logo img {
      max-height: 40px;
      filter: invert(1);

    }

    .header .btn {
      display: flex;
      align-items: center;
      gap: 5px;
      margin-inline-start: auto;
    }

    .header .btn {
      margin-inline-start: 0;
    }

    .header .container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 30px;
      height: 60px;
    }

    /* 1st change ends here */
    .header .container {
      justify-content: end;
      padding: 0;
      width: 100%;

    }

    .navbar {
      top: 0;
      left: -280px;
      width: 100%;
      height: 500px;
      max-width: 280px;
      min-height: 100%;
      padding: 20px;
      visibility: hidden;
      z-index: 2;
      transition: 0.25s var(--cubic-in);
    }

    .navbar.active {
      transform: translateX(280px);
      visibility: visible;
      transition: 0.5s var(--cubic-out);
      background-color: var(--white);
      position: fixed;
      display: inline;
    }

    .navbar-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding-block: 10px 30px;
      margin-left: 30px;
    }

    .navbar-top .logo {
      color: var(--st-patricks-blue);
      font-size: 2.2rem;
      font-weight: var(--fw-700);
    }

    .navbar-top .logo a {
      text-decoration: none;
    }

    .nav-close-btn {
      color: var(--space-cadet-1);
      font-size: 2.8rem;
      padding: 4px;
      background: none;
      border: none;
    }

    .navbar-item:not(:last-child) {
      border-bottom: 1px solid var(--platinum);
    }

    .navbar-item li a:hover {
      text-decoration: none;

    }

    .navbar-link {
      color: var(--space-cadet-1);
      font-size: var(--fs-8);
      font-weight: var(--fw-600);
      padding-block: 12px;
    }

    .overlay {
      position: fixed;
      inset: 0;
      background-color: var(--black_70);
      z-index: 1;
      opacity: 0;
      pointer-events: none;
      transition: var(--transition-2);
    }

    .overlay.active {
      opacity: 1;
      pointer-events: all;
    }


    @media (min-width: 768px) {
      /**
* REUSED STYLE
*/

      .header .container {
        max-width: 720px;
      }
    }

    @media (max-width: 1366px) {
      /* .header .container{
    max-width: 1069px;
  } */
    }

    /* Second Change */
    /**
  * Mobile Navigation 
  */

    .nav-open-btn {
      color: var(--color);
      font-size: 32px;
      padding: 4px;
      background: none;
      border: none;
    }

    @media (min-width: 992px) {
      /**
* CUSTOM PROPERTY
*/

      :root {
        /**
 * typography
 */

        --fs-1: 5.4rem;
      }

      /**
* REUSED STYLE
*/

      .header .container {
        max-width: 1069px;
      }

      /**
* HEADER
*/

      .header {
        padding-block: 20px;
      }

      .overlay,
      .nav-open-btn,
      .navbar-top {
        display: none;
      }

      .navbar,
      .navbar.active {
        all: unset;
        margin-inline-start: auto;
      }

      .header .btn {
        margin-inline-start: 0;
      }

      .navbar-list {
        display: flex;
        gap: 25px;
      }

      .navbar-item:not(:last-child) {
        border-bottom: none;
      }

      .navbar-link {
        color: var(--color);
        font-size: 20px;
      }
    }

    .header .btn {
      background-image: var(--gradient-2);
      background-size: 100%;
      color: var(--white);
      padding: 2px 20px;
      font-size: 20px;
      font-weight: var(--fw-500);
      border-radius: 0 25px;
      transition: var(--transition-2);
    }

    .header .btn:hover {
      background-position: right;
      color: var(--white);
      text-decoration: none;
      text-shadow: 2px 2px#556270;
    }

    .w-100 {
      width: 100%;
    }

    .banner-animation {
      animation: waveAnim 2s linear infinite alternate;
    }

    .center {
      text-align: center;
      /* border: 3px solid green; */

    }


    /* Second change ends here */
    /* Popup overlay is default */
    .popup {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 1;
      background-color: white;
      padding: 20px;
      border-radius: 5px;
      box-shadow: 0px 0px 5px gray;
    }

    .popup-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 1;
    }
/* General Body Styling */

/* Reset some default styling */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  margin: 0;
  padding: 0;
  font-family: 'Arial', sans-serif;
  background-color: #f7f9fc;
  color: #333;
}

/* Main container styling */
#mainContainer {
  background-color: var(--platinum); 
  border-radius: 10px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  padding: 40px; /* Increased padding */
  width: 90%; /* Increased width */
  max-width: 1000px; /* Increased max width */
  margin: 30px auto;
}

#mainContainer h1 {
  font-size: 32px; /* Larger font size */
  margin-bottom: 25px;
  color: #4caf50;
  text-align: center;
}

/* Form styling */
form label {
  font-weight: bold;
  margin: 10px 0 5px;
  display: block;
}

form input,
form select {
  width: 100%;
  padding: 12px; /* Increased padding */
  margin-bottom: 20px; /* Increased spacing */
  border: 1px solid #ccc;
  border-radius: 5px;
  font-size: 16px; /* Larger font size */
}

form button {
  width: 100%;
  padding: 15px;
  background: #4caf50;
  color: white;
  font-size: 18px; /* Larger font size */
  border: none;
  border-radius: 5px;
  cursor: pointer;
}

form button:hover {
  background: #45a049;
}

/* Meal Plan Display Styling */
#mealPlanDisplay {
  background-color: var(--platinum); 
  border-radius: 10px;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
  padding: 40px; /* Increased padding */
  margin: 30px auto;
  width: 95%; /* Increased width */
  max-width: 1600px; /* Increased max width */
  overflow-x: auto;
}

#mealPlanDisplay table {
  width: 100%;
  border-collapse: collapse;
  text-align: center;
}

#mealPlanDisplay th {
  background-color: #4caf50;
  color: white;
  padding: 20px; /* Increased padding */
  font-size: 20px; /* Larger font size */
}

#mealPlanDisplay td {
  padding: 20px; /* Increased padding */
  border: 1px solid #ddd;
  font-size: 18px; /* Larger font size */
}

#mealPlanDisplay td img {
  max-width: 250px; /* Larger image size */
  border-radius: 10px;
}

#mealPlanDisplay a {
  color: #4caf50;
  text-decoration: none;
  font-weight: bold;
  font-size: 18px; /* Larger font size */
}

#mealPlanDisplay a:hover {
  text-decoration: underline;
}

/* Responsive Adjustments */
@media (max-width: 768px) {
  #mainContainer {
    width: 95%;
    padding: 20px; /* Reduced padding for smaller screens */
  }

  #mealPlanDisplay {
    width: 95%;
  }

  #mealPlanDisplay td img {
    max-width: 150px;
  }
}

    .underweight {
      color: #ff6347; /* Tomato red for underweight */
    }

    .normal-weight {
      color: #32cd32; /* Lime green for normal weight */
    }

    .overweight {
      color: #ffa500; /* Orange for overweight */
    }

    .obese {
      color: #ff0000; /* Red for obese */
    }

    .bmr-bmi-info p {
      font-size: 16px;
      font-weight: bold;
    }

    .meal-plan {
      margin-top: 20px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    table, th, td {
      border: 1px solid #ddd;
    }

    th, td {
      padding: 10px;
      text-align: center;
    }

    th {
      background-color: #f4f4f4;
    }
    td img {
      width: 100%;
      max-width: 200px;
      height: auto;
      border-radius: 5px;
      margin: 10px 0;
    }
  
    a {
      text-decoration: none;
      color: #007bff;
      font-weight: bold;
    }
  
    a:hover {
      text-decoration: underline;
    }





  </style>
  <script>
    (function (factory) {
      typeof define === "function" && define.amd
        ? define(factory)
        : factory();
    })(function () {
      "use strict";

      /**
       * The code was extracted from:
       * https://github.com/davidchambers/Base64.js
       */

      var chars =
        "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";

      function InvalidCharacterError(message) {
        this.message = message;
      }

      InvalidCharacterError.prototype = new Error();
      InvalidCharacterError.prototype.name = "InvalidCharacterError";

      function polyfill(input) {
        var str = String(input).replace(/=+$/, "");
        if (str.length % 4 == 1) {
          throw new InvalidCharacterError(
            "'atob' failed: The string to be decoded is not correctly encoded."
          );
        }
        for (
          // initialize result and counters
          var bc = 0, bs, buffer, idx = 0, output = "";
          // get next character
          (buffer = str.charAt(idx++));
          // character found in table? initialize bit storage and add its ascii value;
          ~buffer &&
            ((bs = bc % 4 ? bs * 64 + buffer : buffer),
              // and if not first of each 4 characters,
              // convert the first 8 bits to one ascii character
              bc++ % 4)
            ? (output += String.fromCharCode(255 & (bs >> ((-2 * bc) & 6))))
            : 0
        ) {
          // try to find character in table (0-63, not found => -1)
          buffer = chars.indexOf(buffer);
        }
        return output;
      }

      var atob =
        (typeof window !== "undefined" &&
          window.atob &&
          window.atob.bind(window)) ||
        polyfill;

      function b64DecodeUnicode(str) {
        return decodeURIComponent(
          atob(str).replace(/(.)/g, function (m, p) {
            var code = p.charCodeAt(0).toString(16).toUpperCase();
            if (code.length < 2) {
              code = "0" + code;
            }
            return "%" + code;
          })
        );
      }

      function base64_url_decode(str) {
        var output = str.replace(/-/g, "+").replace(/_/g, "/");
        switch (output.length % 4) {
          case 0:
            break;
          case 2:
            output += "==";
            break;
          case 3:
            output += "=";
            break;
          default:
            throw new Error("base64 string is not of the correct length");
        }

        try {
          return b64DecodeUnicode(output);
        } catch (err) {
          return atob(output);
        }
      }

      function InvalidTokenError(message) {
        this.message = message;
      }

      InvalidTokenError.prototype = new Error();
      InvalidTokenError.prototype.name = "InvalidTokenError";

      function jwtDecode(token, options) {
        if (typeof token !== "string") {
          throw new InvalidTokenError(
            "Invalid token specified: must be a string"
          );
        }

        options = options || {};
        var pos = options.header === true ? 0 : 1;

        var part = token.split(".")[pos];
        if (typeof part !== "string") {
          throw new InvalidTokenError(
            "Invalid token specified: missing part #" + (pos + 1)
          );
        }

        try {
          var decoded = base64_url_decode(part);
        } catch (e) {
          throw new InvalidTokenError(
            "Invalid token specified: invalid base64 for part #" +
            (pos + 1) +
            " (" +
            e.message +
            ")"
          );
        }

        try {
          return JSON.parse(decoded);
        } catch (e) {
          throw new InvalidTokenError(
            "Invalid token specified: invalid json for part #" +
            (pos + 1) +
            " (" +
            e.message +
            ")"
          );
        }
      }

      /*
       * Expose the function on the window object
       */

      //use amd or just through the window object.
      if (window) {
        if (typeof window.define == "function" && window.define.amd) {
          window.define("jwt_decode", function () {
            return jwtDecode;
          });
        } else if (window) {
          window.jwt_decode = jwtDecode;
        }
      }
    });
    //# sourceMappingURL=jwt-decode.js.map
  </script>
  <script>
    // Retrieve the token from local storage
    const token = localStorage.getItem("token");
    // Check if the user is authenticated
    fetch("http://localhost:5000/api/auth", {
      method: "GET",
      headers: {
        "Content-Type": "application/json",
        "x-auth-token": token,
      },
    })
      .then((response) => {
        console.log(response);
        if (response.ok) {
          // User is authenticated, proceed with the dashboard content
          console.log("User is authenticated");

          // Verify the token
          try {
            const decodedToken = jwt_decode(token);
            // The decodedToken variable now contains the decoded token payload

            // Perform any necessary checks or validations on the decoded token
            // For example, you can check the expiration date, user ID, or any other relevant information

            // If the token is valid and meets your criteria, allow access to the dashboard
            // Otherwise, redirect the user to the login page or display an error message
            console.log("Token verification successful:", decodedToken);
          } catch (error) {
            // Error occurred while decoding or verifying the token
            // Redirect the user to the login page or display an error message
            console.error("Token verification failed:", error);
            window.location.href = "http://localhost:8080/login.html";
          }

          // Here you can add your specific dashboard content and functionality
        } else {
          // User is not authenticated, redirect to the login page or handle accordingly
          console.log("User is not authenticated");
          window.location.href = "http://localhost:8080/login.html";
        }
      })
      .catch((error) => {
        console.error("Error checking authentication:", error);
        // Handle error if necessary
      });
  </script>

  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" />
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
</head>

<body style="height: 100%" class="hero">
  <header class="header" data-header>
    <div class="container">
      <div class="overlay" data-overlay></div>
      <h1 class="logo me-auto"><a href="index.html">Zen&Gen</a></h1>

      <a href="index.html" class="logo me-auto">
        <img src="\img\yoga.svg" alt="" />
      </a>

      <nav class="navbar" data-navbar>
        <div class="navbar-top">
          <a href="#" class="logo">ZEN&GEN</a>

          <button class="nav-close-btn" aria-label="Close Menu" data-nav-close-btn>
            <ion-icon name="close-outline"></ion-icon>
          </button>
        </div>

        <ul class="navbar-list">
          <li class="navbar-item"><a href="dashboard.html" class="navbar-link" data-navbar-link>Exercises</a></li>
          <li class="navbar-item"><a href="user_activity.html" class="navbar-link" data-navbar-link> Activities</a></li>
          <li class="navbar-item"><a href="bmi.html" class="navbar-link" data-navbar-link>Diet Plan Generator</a></li>
          <li class="navbar-item"><a href="user_activity_graph.html" class="navbar-link" data-navbar-link> Activity
              Graphs</a></li>
          <!-- <button id="logoutButton" class="logout-button">Logout</button> -->

        </ul>

        <!-- <i class="bi bi-list mobile-nav-toggle"></i> -->

      </nav>
      <button id="logoutButton" class="btn">
        <ion-icon name="chevron-forward-outline" aria-hidden="true"></ion-icon>

        <span>Logout</span>
      </button>
      <button class="nav-open-btn" aria-label="Open Menu" data-nav-open-btn>
        <ion-icon name="menu-outline"></ion-icon>
      </button>
    </div>
  </header>

  <div>
    <div id="mainContainer">
      <h1>Meal Plan Generator</h1>
      <form id="mealForm">
        <label for="age">Age</label>
        <input type="number" id="age" name="age" min="1" required>
  
        <label for="weight">Weight (in kg)</label>
        <input type="number" id="weight" name="weight" min="1" required>
  
        <label for="height">Height (in cm)</label>
        <input type="number" id="height" name="height" min="1" required>
  
        <label for="gender">Gender</label>
        <select id="gender" name="gender" required>
          <option value="male">Male</option>
          <option value="female">Female</option>
        </select>
  
        <label for="activityLevel">Activity Level</label>
        <select id="activityLevel" name="activityLevel" required>
          <option value="1.2">Sedentary (little or no exercise)</option>
          <option value="1.375">Lightly active (light exercise/sports 1-3 days/week)</option>
          <option value="1.55">Moderately active (moderate exercise/sports 3-5 days/week)</option>
          <option value="1.725">Very active (hard exercise/sports 6-7 days a week)</option>
          <option value="1.9">Extra active (very hard exercise/sports & physical job or 2x training)</option>
        </select>
  
        <label for="numOfMeals">Number of Meals</label>
        <select id="numOfMeals" name="numOfMeals">
          <option value="2">Two</option>
          <option value="3">Three</option>
          <option value="5">Five</option>
        </select>
  
        <label for="dietPreference">Diet Preference</label>
        <select id="dietPreference" name="dietPreference">
          <option value="balanced">Balanced</option>
          <option value="lowCarb">Low-Carb</option>
          <option value="lowFat">Low-Fat</option>
        </select>
  
        <label for="healthSpec">Health Specification</label>
        <select id="healthSpec" name="healthSpec">
          <option value="">No options</option>
          <option value="vegan">Vegan</option>
          <option value="vegetarian">Vegetarian</option>
          <option value="alcoholFree">Alcohol-Free</option>
          <option value="peanutFree">Peanut-Free</option>
          <option value="gluten-free">Gluten-Free</option>
        </select>
  
        <button type="submit">Generate Meal Plan</button>
      </form>
    </div>
  
    <!-- Meal plan display below the form -->
    <div id="mealPlanDisplay"></div>
  </div>
  
  
  
  <script>
    

    document.getElementById('mealForm').addEventListener('submit', generateMealPlan);

function generateMealPlan(event) {
  event.preventDefault();

  const age = document.getElementById('age').value;
  const weight = document.getElementById('weight').value;
  const height = document.getElementById('height').value;
  const gender = document.getElementById('gender').value;
  const activityLevel = document.getElementById('activityLevel').value;
  const numOfMeals = document.getElementById('numOfMeals').value;
  const dietPreference = document.getElementById('dietPreference').value;
  const healthSpec = document.getElementById('healthSpec').value;

  // Validate age, weight, and height inputs
  if (!isValidAge(age) || !isValidWeight(weight) || !isValidHeight(height)) {
    alert('Please enter valid age, weight, and height values.');
    return;
  }

  let bmr;
  if (gender === 'male') {
    bmr = 88.362 + (13.397 * weight) + (4.799 * height) - (5.677 * age);
  } else if (gender === 'female') {
    bmr = 447.593 + (9.247 * weight) + (3.098 * height) - (4.330 * age);
  }

  // Calculate BMI (Body Mass Index)
  const heightInMeters = height / 100;
  const bmi = (weight / (heightInMeters * heightInMeters)).toFixed(2);

  // Determine BMI message
  let bmiMessage = '';
  let bmiClass = '';
  if (bmi < 18.5) {
    bmiMessage = 'Underweight';
    bmiClass = 'underweight';
  } else if (bmi >= 18.5 && bmi < 24.9) {
    bmiMessage = 'Normal weight';
    bmiClass = 'normal-weight';
  } else if (bmi >= 25 && bmi < 29.9) {
    bmiMessage = 'Overweight';
    bmiClass = 'overweight';
  } else {
    bmiMessage = 'Obese';
    bmiClass = 'obese'; // Adjusted for obesity
  }

  const calories = Math.round(bmr * activityLevel);
  const totalMeals = numOfMeals * 7; // Fetch enough meals for a week

  // Edamam API details
  const APP_ID = "8105462b";
  const APP_KEY = "b143670346694219bd06e3f2d9cca02e";

  // Construct API URL dynamically based on inputs
  let apiUrl = `https://api.edamam.com/search?q=${dietPreference}&app_id=${APP_ID}&app_key=${APP_KEY}&from=0&to=${totalMeals}&calories=${calories}&cuisineType=indian`;

  // Add health parameter only if it's not "No options"
  if (healthSpec) {
    apiUrl += `&health=${healthSpec}`;
  }

  fetch(apiUrl)
    .then(response => response.json())
    .then(data => displayMealPlan(data.hits, numOfMeals, bmi, bmr, bmiMessage, bmiClass))
    .catch(error => console.error('Error:', error));
}

function isValidAge(age) {
  return age && !isNaN(age) && age > 0 && age < 130;  // A valid age should be a number between 1 and 130
}

function isValidWeight(weight) {
  return weight && !isNaN(weight) && weight > 10 && weight < 500;  // Valid weight should be between 10 kg and 500 kg
}

function isValidHeight(height) {
  return height && !isNaN(height) && height >= 50 && height <= 250;  // Valid height should be between 50 cm and 250 cm
}

function displayMealPlan(meals, numOfMeals, bmi, bmr, bmiMessage, bmiClass) {
  const mealPlanDisplay = document.getElementById('mealPlanDisplay');
  mealPlanDisplay.innerHTML = ''; // Clear previous meal plan

  // Create BMI and BMR results with nice styling
  const infoDiv = document.createElement('div');
  infoDiv.classList.add('bmr-bmi-info');
  infoDiv.innerHTML = `
    <p><strong>Your BMI:</strong> ${bmi}</p>
    <p><strong>Your BMR:</strong> ${bmr} kcal/day</p>
    <p class="${bmiClass}">${bmiMessage}</p>
  `;
  mealPlanDisplay.appendChild(infoDiv);

  // Create table and headings for the meal plan
  const table = document.createElement('table');
  const thead = document.createElement('thead');
  const tbody = document.createElement('tbody');
  const days = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];

  const headerRow = document.createElement('tr');
  days.forEach(day => {
    const th = document.createElement('th');
    th.textContent = day;
    headerRow.appendChild(th);
  });
  thead.appendChild(headerRow);
  table.appendChild(thead);

  // Fill table with meal data
  for (let i = 0; i < numOfMeals; i++) {
    const row = document.createElement('tr');
    for (let j = 0; j < 7; j++) {
      const meal = meals[i * 7 + j]?.recipe;
      if (meal) {
        const cell = document.createElement('td');
        cell.innerHTML = `
          <p style="font-weight: bold; margin: 5px 0;">${meal.label}</p>
          <img src="${meal.image}" alt="${meal.label}" style="width: 100%; max-width: 200px; height: auto; border-radius: 5px; margin: 10px 0;">
          <a href="${meal.url}" target="_blank" style="text-decoration: none; color: #007bff;">View Recipe</a>
        `;
        row.appendChild(cell);
      }
    }
    tbody.appendChild(row);
  }
  table.appendChild(tbody);

  mealPlanDisplay.appendChild(table);
}

  </script>
</body>
</html>